PCA_FUN<-function(pca_try ,LABEL_INDIVIDUAL=LABEL_INDIVIDUAL,LABEL_REP=LABEL_REP,textsize=4,pointsize=0.5,legendpointsize=1,legend_key_size=1,TITLE=''){
    
    
    
    
    pr_v<-summary(pca_try )$importance[2,]*100
    percentage <- paste( colnames(pca_try$x), "(", paste( as.character(pr_v), "%", ")", sep="") )
    dat<-pca_try$x[,1:2]
    library(ggplot2)
    BATCH<-ggplot(data=as.data.frame(dat),aes(x=PC1,y=PC2))+geom_point(aes(color=as.factor(LABEL_INDIVIDUAL),shape=as.factor(LABEL_REP)),size=pointsize)+labs(color='Individual',shape='Replicate') + 
        xlab(percentage[1]) + 
        ylab(percentage[2])+
        ggtitle(TITLE)+
        guides(color = guide_legend(override.aes = list(size=legendpointsize)),shape = guide_legend(override.aes = list(size=legendpointsize)))+
        theme(legend.text = element_text(size = textsize),legend.title  = element_text(size = textsize),axis.title = element_text(size = textsize),panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(), axis.line = element_line(colour = "black"),plot.subtitle = element_text(size =textsize),plot.caption =  element_text(size = textsize),axis.text=element_text(size=textsize) ,
              #legend.position =c(0.8,0.8),
              legend.position ='top',
              legend.key.size = unit(legend_key_size,"line"))
    return(BATCH)
}
